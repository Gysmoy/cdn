<?php class JSON{public static function parse(string $text):array{$array=json_decode($text,true);return $array;}public static function stringify(mixed $object,bool $pretty=false):string{if($pretty){$string=json_encode($object,JSON_PRETTY_PRINT);}else{$string=json_encode($object);}return $string;}public static function parseable(mixed $text):array|false{$json=json_decode($text,true);return(json_last_error()==JSON_ERROR_NONE?$json:false);}public static function flatten($obj,$notation='.',$prefix='',$flattenLastArray=true){return array_reduce(array_keys($obj),function($acc,$k)use($notation,$prefix,$flattenLastArray,$obj){$pre=strlen($prefix)?$prefix.$notation:'';if(is_array($obj[$k])){if($flattenLastArray&&!is_array($obj[$k][0])){foreach($obj[$k]as $i=>$item){$acc[$pre.$k.'['.$i.']']=$item;}}else{$acc[$pre.$k]=$obj[$k];}}else if(is_object($obj[$k])){$acc+=JSON::flatten((array) $obj[$k],$notation,$pre.$k,$flattenLastArray);}else{$acc[$pre.$k]=$obj[$k];}return $acc;},[]);}public static function unflatten($obj,$notation='.'){$result=[];foreach($obj as $key=>$value){$keys=explode($notation,$key);$cur=&$result;foreach($keys as $i=>$prop){if(strpos($prop,'[')!==false&&strpos($prop,']')===strlen($prop)-1){$index=intval(substr($prop,strpos($prop,'[')+1,-1));$prop=substr($prop,0,strpos($prop,'['));if(!isset($cur[$prop])){$cur[$prop]=[];}while(count($cur[$prop])<$index){$cur[$prop][]=[];}if($i===count($keys)-1){$cur[$prop][$index]=$value;}else{if(!isset($cur[$prop][$index])){$cur[$prop][$index]=[];}$cur=&$cur[$prop][$index];}}else{if($i===count($keys)-1){$cur[$prop]=$value;}else{if(!isset($cur[$prop])){$cur[$prop]=[];}$cur=&$cur[$prop];}}}unset($cur);}return $result;}public static function take(array $obj,int $quantity){return array_slice($obj,0,$quantity);}public static function getJSON(string $text){$startIndex=-1;$braceCount=0;$bracketCount=0;for($i=0;$i<strlen($text);$i++){if($text[$i]==='{'){if($startIndex===-1){$startIndex=$i;}$braceCount++;}else if($text[$i]==='}'){$braceCount--;}else if($text[$i]==='['){if($startIndex===-1){$startIndex=$i;}$bracketCount++;}else if($text[$i]===']'){$bracketCount--;}if($braceCount===0&&$bracketCount===0&&$startIndex!==-1){$json=substr($text,$startIndex,$i-$startIndex+1);try{return json_decode($json);}catch(Exception $e){return null;}}}return null;}}